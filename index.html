<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BNB والیټ کونیکټور</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        header {
            background-color: #f0b90b;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            color: white;
        }
        
        .main-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .wallet-section {
            margin-bottom: 20px;
        }
        
        .wallet-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .wallet-btn {
            background-color: #f0b90b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .wallet-btn:hover {
            background-color: #d8a90a;
        }
        
        .wallet-btn img {
            width: 20px;
            height: 20px;
        }
        
        .wallet-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .wallet-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            display: none;
        }
        
        .balance {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .token-distribution {
            margin-top: 20px;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <h1>BNB والیټ کونیکټور</h1>
        <p>خپل BNB سمارټ چین والیټ وصل کړئ</p>
    </header>
    
    <div class="main-content">
        <div class="wallet-section">
            <h3>والیټ انتخاب کړئ:</h3>
            <div class="wallet-buttons">
                <button class="wallet-btn" id="metamaskBtn">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg" alt="MetaMask">
                    MetaMask
                </button>
                <button class="wallet-btn" id="trustwalletBtn">
                    <img src="https://trustwallet.com/assets/images/media/assets/TWT.png" alt="Trust Wallet">
                    Trust Wallet
                </button>
                <button class="wallet-btn" id="tokenpocketBtn">
                    <img src="https://assets.tokenpocket.sg/icon/TP-logo.png" alt="TokenPocket">
                    TokenPocket
                </button>
                <button class="wallet-btn" id="okxBtn">
                    <img src="https://www.okx.com/cdn/assets/imgs/239/4CCE7D5B1D1E503A.png" alt="OKX">
                    OKX Wallet
                </button>
                <button class="wallet-btn" id="binanceBtn">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/57/Binance_Logo.png" alt="Binance">
                    Binance Chain
                </button>
            </div>
            
            <div id="walletInfo" class="wallet-info">
                <h3>والیټ وصل شو</h3>
                <p>ادرس: <span id="walletAddress"></span></p>
                <p>نیټورک: <span id="walletNetwork"></span></p>
                <div class="balance">
                    بیلانس: <span id="walletBalance">0</span> BNB
                </div>
            </div>
        </div>
        
        <div id="tokenDistribution" class="token-distribution hidden">
            <h2>ټوکن ویش</h2>
            <p>تاسو 1000-10000 DR ټوکنونه ترلاسه کړي!</p>
        </div>
    </div>

    <!-- د Firebase او BNB چین لایبریرۍ -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.7.8/dist/umd/index.min.js"></script>

    <script>
        // د Firebase کانفیګوریشن
        const firebaseConfig = {
            apiKey: "AIzaSyD4UbW_Iy4kUWH3V70Q1mWCI4-_KFk6ku4",
            authDomain: "onlinewark-a0147.firebaseapp.com",
            databaseURL: "https://onlinewark-a0147-default-rtdb.firebaseio.com",
            projectId: "onlinewark-a0147",
            storageBucket: "onlinewark-a0147.appspot.com",
            messagingSenderId: "92155538620",
            appId: "1:92155538620:android:5e198a8eea6bf17f61f4b9"
        };

        // Firebase ته پیل ورکړئ
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // د والیټ وصلولو فنکشن
        async function connectWallet(walletType) {
            try {
                let provider;
                let account;
                
                // د مختلفو والیټونو لپاره وصلولو میتودونه
                switch(walletType) {
                    case 'metamask':
                        if (!window.ethereum) {
                            throw new Error('مهرباني وکړئ MetaMask انسټال کړئ');
                        }
                        provider = window.ethereum;
                        await provider.request({ method: 'eth_requestAccounts' });
                        break;
                        
                    case 'trustwallet':
                        if (!window.ethereum) {
                            throw new Error('مهرباني وکړئ Trust Wallet انسټال کړئ');
                        }
                        provider = window.ethereum;
                        await provider.request({ method: 'eth_requestAccounts' });
                        break;
                        
                    case 'tokenpocket':
                        if (!window.tokenpocket) {
                            throw new Error('مهرباني وکړئ TokenPocket انسټال کړئ');
                        }
                        provider = window.tokenpocket.ethereum;
                        await provider.request({ method: 'eth_requestAccounts' });
                        break;
                        
                    case 'okx':
                        if (!window.okxwallet) {
                            throw new Error('مهرباني وکړئ OKX Wallet انسټال کړئ');
                        }
                        provider = window.okxwallet;
                        await provider.request({ method: 'eth_requestAccounts' });
                        break;
                        
                    case 'binance':
                        provider = new WalletConnectProvider({
                            rpc: {
                                56: "https://bsc-dataseed.binance.org/"
                            }
                        });
                        await provider.enable();
                        break;
                        
                    default:
                        throw new Error('ناسم والیټ ټایپ');
                }
                
                // Web3 ته پیل ورکړئ
                const web3 = new Web3(provider);
                const accounts = await web3.eth.getAccounts();
                account = accounts[0];
                
                // د والیټ معلومات ښکاره کړئ
                document.getElementById('walletAddress').textContent = account;
                document.getElementById('walletInfo').style.display = 'block';
                
                // د نیټورک معلومات ترلاسه کړئ
                const chainId = await web3.eth.getChainId();
                let networkName;
                switch(chainId) {
                    case 56: networkName = "BNB Smart Chain"; break;
                    case 97: networkName = "BNB Smart Chain Testnet"; break;
                    default: networkName = `Unknown (${chainId})`;
                }
                document.getElementById('walletNetwork').textContent = networkName;
                
                // د بیلانس ترلاسه کړئ
                const balance = await web3.eth.getBalance(account);
                const balanceInBNB = web3.utils.fromWei(balance, 'ether');
                document.getElementById('walletBalance').textContent = balanceInBNB;
                
                // Firebase ته خوندي کړئ
                saveWalletToFirebase(account, balanceInBNB, walletType);
                
                // د ټوکنونو ویش
                if (parseFloat(balanceInBNB) > 0) {
                    distributeTokens(account);
                }
                
                // د Home پاڼې ته لیږد
                setTimeout(() => {
                    window.location.href = "https://afgtrade.github.io/FreeTonCoin";
                }, 2000);
                
            } catch (error) {
                console.error('د والیټ په وصلولو کې ستونزه:', error);
                alert(`ستونزه: ${error.message}`);
            }
        }

        // د والیټ معلومات Firebase ته خوندي کول
        function saveWalletToFirebase(address, balance, walletType) {
            const walletRef = database.ref('wallets/' + address);
            walletRef.set({
                address: address,
                balance: balance,
                walletType: walletType,
                connectedAt: new Date().toISOString()
            }).then(() => {
                console.log('والیټ Firebase ته خوندي شو');
            }).catch((error) => {
                console.error('د والیټ په خوندي کولو کې ستونزه:', error);
            });
        }

        // د ټوکنونو ویش
        function distributeTokens(address) {
            // د ټوکن ویش برخه ښکاره کړئ
            document.getElementById('tokenDistribution').classList.remove('hidden');
            
            // د 1000 او 10000 ترمنځ تصادفي مقدار
            const tokenAmount = Math.floor(Math.random() * 9001) + 1000;
            
            // د ټوکن ویش Firebase ته خوندي کول
            const tokensRef = database.ref('tokenDistributions/' + address);
            tokensRef.set({
                token: 'DR',
                amount: tokenAmount,
                distributedAt: new Date().toISOString()
            }).then(() => {
                console.log('ټوکنونه ویشل شوي او Firebase ته خوندي شول');
            }).catch((error) => {
                console.error('د ټوکنونو په ویشلو کې ستونزه:', error);
            });
        }

        // د والیټ بټنونو لپاره ایونټ لیسنر
        document.getElementById('metamaskBtn').addEventListener('click', () => connectWallet('metamask'));
        document.getElementById('trustwalletBtn').addEventListener('click', () => connectWallet('trustwallet'));
        document.getElementById('tokenpocketBtn').addEventListener('click', () => connectWallet('tokenpocket'));
        document.getElementById('okxBtn').addEventListener('click', () => connectWallet('okx'));
        document.getElementById('binanceBtn').addEventListener('click', () => connectWallet('binance'));

        // د پیل په وخت کې د وصل شوي والیټ چک
        window.addEventListener('load', async () => {
            if (window.ethereum) {
                try {
                    const web3 = new Web3(window.ethereum);
                    const accounts = await web3.eth.getAccounts();
                    if (accounts.length > 0) {
                        // والیټ دمخه وصل دی
                        const account = accounts[0];
                        document.getElementById('walletAddress').textContent = account;
                        document.getElementById('walletInfo').style.display = 'block';
                        
                        // د نیټورک معلومات
                        const chainId = await web3.eth.getChainId();
                        let networkName;
                        switch(chainId) {
                            case 56: networkName = "BNB Smart Chain"; break;
                            case 97: networkName = "BNB Smart Chain Testnet"; break;
                            default: networkName = `Unknown (${chainId})`;
                        }
                        document.getElementById('walletNetwork').textContent = networkName;
                        
                        // د بیلانس ترلاسه کړئ
                        const balance = await web3.eth.getBalance(account);
                        const balanceInBNB = web3.utils.fromWei(balance, 'ether');
                        document.getElementById('walletBalance').textContent = balanceInBNB;
                    }
                } catch (error) {
                    console.error('د وصل شوي والیټ په چک کې ستونزه:', error);
                }
            }
        });
    </script>
</body>
</html> 
